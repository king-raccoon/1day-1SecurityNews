# WordPress Skimmers Evade Detection by Injecting Themselves into Database Tables
## Jan 13, 2025
### [The Hacker News](https://thehackernews.com/2025/01/wordpress-skimmers-evade-detection-by.html)
---
<br>

## WordPress 기반 스키머 캠페인

악의적인 자바스크립트 코드를 CMS 관련 데이터베이스 테이블에 삽입하여 워드프레스의 전자상거래 결제 페이지를 대상으로 한 **credit card skimmer campaign**에 의해 경고받고 있다. 이를 통해 민감한 결제 정보, 카드 정보 등이 공격자에게 유출될 수 있다. 

> **How to Work**<br>
`wp_options` 테이블에 **widget_block**이라는 옵션 이름으로 악성코드를 삽입하여 보안 스캐닝 도구나 관리자가 악성코드 삽입 여부 파악을 어렵게 했다.
<br>
결제 정보 유출 등을 통해 필요한 자바스크립트 코드는 워드프레스의 HTML 블록 위젯을 통해 삽입됐다. (이는 정상적인 동작 방식이고, 관리자 패널에서 위젯 관리 메뉴를 통해 삽입이 가능하다. 공격자는 admin 계정 정보 등을 탈취하여 악의적인 코드를 삽입할 수 있게 된다.)<br>
삽입된 자바스크립트 코드는 해당 페이지가 결제 페이지인지를 확인하고, 맞다면 사용자가 결제 정보 입력 직전에 작동하여 가짜 결제 화면을 동적으로 생성하여 사용자가 입력한 결제 정보를 공격자에게 전송한다. 
<br>
탈취한 정보는 Base64를 통해 ASCII 형식으로 변환하고, AES-CBC를 통해 암호화하여 노출되도 복호화를 어렵게 만들어 공격자가 제어하는 C2C 서버(`valhafather.xyz`, `fqbe23.xyz`)로 전송한다.
<br>
>> What is `wp_options`?<br>
WordPress에서 사이트 설정, 플러그인 설정, 테마 설정과 같은 설정 정보 저장하는 테이블<br>

## PayPal 피싱 캠페인
이번 사례는 약 2,200 달러 미결제 결제 요청을 가장해 피해자가 PayPal 로그인 페이지에 클릭하도록 유도학 피싱 이메일 캠페인에서 발견됐다. <br>
해당 피싱 사례에서는 실제 PayPal 주소(service@paypal.com)에서 메일이 발송됐고 실제 로그인 URL이 포함됐기 때문에 탐지가 어려웠다. 또한 피해자가 로그인을 시도하는 순간 자동으로 배포 목록에 이메일 주소가 연결되어 계정 제어권이 공격자에게 넘어갈 수 있다.

## Transaction Simulation Spoofing
Web3 지갑이 사용자 편의성 제공을 위해 거래 시뮬레이션 기능을 제공하고 있다. 사용자는 해당 기능을 통해 거래 예상 결과를 미리 확인할 수 있어 해당 거래로 인해 얼마가 어디로 이동할 수 있는지 확인할 수 있어 **Transparency(투명성)** 과 사용자 경험 향상에 도움이 된다. <br>
그러나 공격자는 시뮬레이션과 실제 거래 사이의 시간 차이를 악용할 수 있다. 공격자는 해당 시간 차를 이용해 DApps을 모방한 가짜 사이트를 생성하여 피해자 지갑에서 자금 탈취를 수행할 수 있다. 

## Conclusion
악성코드와 피싱 공격이 점점 정교해지고 탐지가 어려워지는 방식으로 진화하고 있다.

### Relative articles

### What's new for me
- CMS : Content Management System. WordPress, Magento, OpenCart 같이 사용자 친화적인 인터페이스 제공을 통해 사용자가 쉽게 디지털 콘텐츠를 생성, 관리, 저장 및 수정이 가능하게 하는 소프트웨어
- resist analysis : 분석 저항성, 암호화된 데이터의 복호화가 어려운 점을 사용하여 보안 분석사가 내용을 복구하거나 악성 행위 추적하기 어렵게 만듦


#WordPress #anti-detection #malicious-code #Javascript #phishing-email #Web3 #DApps