# 악성코드를 대신 배포해 주는 새로운 서비스, DaaS는 무엇인가
## Jan 15, 2025
### [보안뉴스]](https://www.boannews.com/media/view.asp?idx=131915)
---
<br>

보안 업체 체크포인트(Checkpoint)는 특이점을 가진 DaaS를 발견헀고, 이러한 DaaS 서비스에 스타게이저고스트(Stargazers Ghost), 해당 거대 공격 인프라(배포 인프라)를 운영하고 있는 세력을 스타게이저고블린(Stargazers Goblin)이라고 이름 붙였다.

현재 스타게이저고스트의 배후 세력이 운영하고 있는 공격 인프라가 최소 3천 개 깃허브 계정으로 추정되고 있다. 

수많은 가짜 계정 운영과 깃허브를 악용한 사례는 이미 많으나, 공급망 공격이 유행이고 깃허브가 공급망 공격에 악용되고 있으나 기존 공격은 이미 개발자가 만든 정상적인 계정에 공격자가 침해하여 악의적인 코드를 삽입하는 반면 이번 사례는 공격자가 처음부터 가짜 계정을 대량으로 만들어 멀웨어를 유포하고 있기 때문에 주의를 기울이고 있다. 

### 공격 방식
**공격 포인트 1** 
<br>수많은 계정이 유령 계정처럼 보이지 않게 하기 위해 콘텐츠 공유하기, 좋아요 등의 활동을 진행<br>
계정의 꾸준한 활동을 통해 1회성 공격이 아닌 거대 규모의 공격 인프라를 상시 대기시켜두는 효과 -> 4일에 1300명 피해자가 정보 탈취형 멀웨어(아틀란티다스틸러, Atlantida Stealer) 감염됨
<br>

**공격 포인트 2** 
<br>하나의 공격 이행 시, 해당 공격에 소요되는 단계를 세분화하여 각 임무를 별도의 계정에 부여<br>
ex) 악성 파일 다운로드하도록 피싱 링크 노출시킬 때, 미끼옹 레포지토리 템플릿 제공하는 계정1, 미끼용 레포지토리 템플릿에 사용되는 가짜 이미지 로딩하는 계정 2, 아카이브 형태로 저장된 실제 멀웨어 페이로 발동하는 계정 3<br>

>*계정을 나눴을 때의 공격자가 갖는 이득* 
>1. 문제 발생 시 대처가 쉬움
>  - 계정 하나 삭제되도 재빨리 다시 만들면 그만 
>2. 탐지 리스크 분산 
>  - 멀웨어 페이로드 계정이 탐지되도, 다른 계정은 직접 연결되지 않도록 설계하여 전부 차단될 가능성 낮아짐
>3. 공격 운영 효율성 증가

체크포인트는 스타게이저고블린이 자동화 기술을 통해 주기적으로 자신의 DaaS 네트워크를 점검한다고 추정하고 있다.

### 대표적으로 사용된 멀웨어
- 아틀란디다스틸러
- 라다만티스(Rhadamanthys)
- 라이즈프로(RisePro)
- 룸마스틸러(Lumma Stealer)
- 레드라인(RedLine)

### 실제 캠페인 사례 1
악성 깃허브 링크를 디스코드 등으로 전파하여 아틀란티다스틸러 유포한 사례<br>
공격 표적 : 트위치 사용자<br>
공격자들은 미리 WordPress 웹사이트 침해해 악성 스크립트 호스팅해두고, 피해자가 악성 레포지터리로부터 WordPress 사이트의 악성 스크립트 다운로드 및 로딩되게 함 <br>
피해자들이 다운로드한건 `index.php`의 PHP 파일로, 해당 파일은 HTTP 요청문의 헤더를 먼저 확인하여 요청의 출처가 깃허브인지 확인하고, IP주소가 토르 네트워크나 그 외 블랙리스트 처리된 IP주소인지 확인. 조건이 맞다면 HTTP 요청 우회시켜 `download.php`가 피해자 시스템에 다운로드 되도록 하고, 이 때 악성 iFrame이 포함된 .hta 파일(Impress_V1.0.2.hta)이 같이 다운로드되면서 악성 비주얼베이직 스크립트가 실행됨
> 공격 포인트 : 고도의 표적형 캠페인으로, 피해자를 해당 분야를 잘 모르는 사람으로 선정
---
### 실제 캠페인 사례 2

라이즈프로라는 정보 탈취형 멀웨어 사용 <br>
"보안 위협인 라이즈프로의 크랙 버전을 받아가세요"라는 문구를 미끼로, 캠페인 표적이 보안 전문가인지 해커인지 헷갈림. <br>
다운로드 링크 클릭 시 피싱 템플릿이 나타나고, 피해자가 아카이브 파일을 다운로드하게 만듦. 해당 아카이브 내 다운로더가 숨겨져 있어 해당 다운로더로부터 라다만티스가 피해자 시스템에 심겨짐<br>
공격자들이 다운로더에 GET 요청하는 기술도 첨가하여 감염된 IP주소를 등록시켜 공격 통계까지 내고 있음. 

---
실제 스타게이저고블린은 공격을 실행하는 대상이 아닌 인프라를 제공하는 제공처라고 보는 게 맞다. 몇 개의 계정을 사용하냐에 따라 사용 가격이 달라진다. 


### What's new for me
- DaaS(Distributin-as-a-Servive): 공격자가 악성코드를 유포하기 위한 서비스형 공격 인프라를 운영하고, 이를 다른 공격자에게 대여하거나 판매하는 모델
- 공급망 공격(Supply Chain Attack): 소프트웨어가 개발되고 시장에 유통되는 과정 자체에 공격자가 개입하여 멀웨어를 퍼트리는 것
  - 예: 소프트웨어 빌드에 사용되는 코드 라이브러리 또는 개별 구성요소의 오염, 소프트웨어 업데이트 바이너리가 트로이 목마에 감염, 코드 서명 인증서 도난, SaaS를 호스팅하는 서버 손상

#DaaS #supply_chain_attack #StargazersGhost #StargazersGoblin #malware_distribution #fake_accounts #GitHub #GitHub_repository