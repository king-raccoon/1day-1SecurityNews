# Unsecured Tunneling Protocols Expose 4.2 Million Hosts, Including VPNs and Routers
## Jan 20, 2025
### [The Hacker News](https://thehackernews.com/2025/01/unsecured-tunneling-protocols-expose-42.html)
---
<br>

여러 터널링 프로토콜에서 공격자가 광범위 공격 수행을 가능하게 하는 취약점들이 발견됐다. 

발신자 검증 없이 터널링된 패킷을 받는 인터넷 호스트들은 익명의 공격자들에게 하이재킹될 수 있고, 공격자에게 네트워크 할 수 있게 된다.<br>
공격자가 해당 취약점을 익스플로잇하면 취약한 시스템을 단방향 프록시로 악용하고 DoS 공격 수행할 수 있다. 
> 단방향 프록시로 사용하면 뭐가 문젠데?<br>
>- 프록시 : 클라이언트와 인터넷 서바 중개 역할 수행 -> 사용자는 자신의 IP 숨기고 익명성 유지 가능<br>
>- 단방향 프록시로 사용 시 공격자가 제어하는 특정 방향(예. 표적 시스템 -> 프록시 -> 표적 서버)에만 사용 가능하여 추적 피하고 보안 시스템의 탐지 우회할 수 있음

해당 취약점은 IP6IP6, GRE6, 4in6, 6in4와 같이 연결되지 않은 두 네트워크 간 데이터 전송을 돕는 터널링 프로토콜이 IPsec과 같은 보안 프로토콜 없이 트래픽 인증 및 암호화하지 않는다는 점을 악용했다.

### 공격자는 해당 취약점을 어떻게 이용해 익명 공격을 하는가
1. 공격자는 취약한 프로토콜 중 하나를 통해 2개의 IP 헤더가 포함된 패킷 전송
2. 외부(첫 번째) 헤더<br>출발지 IP : 공격자의 출발지 IP, 목적지 IP : 취약한 호스트의 IP<br>내부(두 번째) 헤더<br>출발지 IP : 취약한 호스트의 IP<br>목적지 IP : 공격 대상이 되는 시스템 IP<br>
=> **내부 패킷의 출발지 IP는 취약하지만 신뢰할 수 있는 호스트 IP로 설정되어 있기 때문에 네트워크 필터 우회 가능**

### 취약한 호스트 종류
VPN 서버, ISP 홈 라우터, 코어 인터넷 라우터, 모바일 네트워크 게이트웨이, 콘텐츠 전송 네트워크(CDN) 노드 등 420만 개의 호스트

### CVE
- CVE-2024-7595 (GRE and GRE6)
- CVE-2024-7596 (Generic UDP Encapsulation)
- CVE-2025-23018 (IPv4-in-IPv6 and IPv6-in-IPv6)
- CVE-2025-23019 (IPv6-in-IPv4)



<br>

### What's new for me
- VPN server : 사용자의 인터넷 트래픽 암호화하여 원격 서버를 통해 보안된 경로로 데이터 전송하는 데 사용 
  - VPN 연결 시, VPN 서버가 실제 사용자 IP 숨기고 새로운 IP 주소 할당
  - 보안 강화, 위치 숨김(익명성), 우회 접속(지리적 차단 회피) 등에 사용
- ISP Home Router : ISP(인터넷 서비스 제공업체)가 제공하는 가정용 인터넷 라우터, 인터넷 연결 관리가 목적
  - 가정에서 사용하는 Wi-Fi 공유기
  - 사용자에게 IP 주소 할당, 인터넷 연결을 여러 장치(PC, 스마트폰 등) 공유
    - 여러 대 기기 각각에 IP 할당하여 인터넷을 모든 장치에 동시에 제공 가능
  - 와이파이 기능, 방화벽 기능 함께 제공되는 경우 존재
- Core Internet Router : 인터넷의 backborn(핵심) 구성하는 대규모 라우터
  - 글로벌 인터넷 트래픽 관리, 고속으로 데이터 패킷 라우팅
  - ISP, 데이터센터, 대형 기업 간의 인터넷 트래픽 처리하는 데 사용
  - 초고속 네트워크 속도와 안전성 보장하기 위해 설계됨
  - 예. 국가 간, 대륙 간 트래픽 연결하는 백본 네트워크 라우터
- Mobile Networ Gateway : 이동통신망과 인터넷 연결하는 중개 장치, 모바일 기기가 인터넷에 접속할 수 있도록 함
  - IP 패킷을 모바일 네트워크와 인터넷 간에 변환하는 역할
  - 보안 기능 및 트래픽 기능 추가 가능
- CDN node 
  - CDN : 웹사이트 콘텐츠를 사용자와 가까운 서버에서 빠르게 제공하기 위한 네트워크
  - 콘텐츠 응답 속도 줄이고 로딩 시간 단축
  - 지리적으로 분산된 노드(서버) 통해 부하 분산 및 웹사이트 성능 향상

#tunneling_protocol #vulnerability #network_security #one-way-proxy #anonymouy_attack #traffic_filtering #DoS #DDoS